#!/usr/bin/env stap

probe vfs.write.return {
  if ((pid() == target()) && (ret > 0) && (devname != "N/A")) {
    printf("WRITE: %s - %s\n", kernel_string(@cast($file->f_path->mnt, "vfsmount")->mnt_devname), kernel_string($file->f_path->dentry->d_name->name))
  }
}


probe vfs.read.return {
  if ((pid() == target()) && (ret > 0) && (devname != "N/A")) {
    printf("READ: %s - %s\n", kernel_string(@cast($file->f_path->mnt, "vfsmount")->mnt_devname), kernel_string($file->f_path->dentry->d_name->name))
  }
}
